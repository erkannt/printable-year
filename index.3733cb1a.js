const e=document.querySelector("#appContainer");if(!e)throw Error("ERROR: no appContainer found");const t=document.querySelector("#yearInput");if(!t)throw Error("ERROR: no yearInput found");if(!(t instanceof HTMLInputElement))throw Error("ERROR: yearInput not an input");const n=document.querySelector("#monthsPerPage");if(!n)throw Error("ERROR: no monthsPerPageInput found");if(!(n instanceof HTMLSelectElement))throw Error("ERROR: monthsPerPage not a select");const a=document.querySelector("#shadeWeekends");if(!a)throw Error("ERROR: no shadeWeekendInput found");if(!(a instanceof HTMLInputElement))throw Error("ERROR: shadeWeekendsInput not an input");const r=document.querySelector("#showWeeknumbers");if(!r)throw Error("ERROR: no showWeeknumbersInput found");if(!(r instanceof HTMLInputElement))throw Error("ERROR: showWeeknumbersInput not an input");const o=(e,t)=>{let n=[],a=new Date(e,t,1);for(;a.getFullYear()===e&&a.getMonth()===t;)n.push(new Date(a)),a.setDate(a.getDate()+1);return n},d=(e,t)=>{let n=new Intl.DateTimeFormat("default",{year:"2-digit"}),a=new Intl.DateTimeFormat("default",{month:"long"}),r=document.createElement("span"),o=new Date(e,t),d=a.format(o);return 0===t&&(d=`${d} '${n.format(o)}`),r.textContent=d,r.classList.add("month","calendarItem"),r.setAttribute("data-month",(o.getMonth()+1).toString()),r},u=e=>{let t=new Date(e.getTime());t.setHours(0,0,0,0),// Thursday in current week decides the year.
t.setDate(t.getDate()+3-(t.getDay()+6)%7);// January 4 is always in week 1.
let n=new Date(t.getFullYear(),0,4);// Adjust to Thursday in week 1 and count number of weeks from date to week1.
return 1+Math.round(((t.getTime()-n.getTime())/864e5-3+(n.getDay()+6)%7)/7)},i=e=>{let t=new Intl.DateTimeFormat("default",{day:"2-digit"}),n=new Intl.DateTimeFormat("default",{weekday:"narrow"}),a=document.createElement("div");a.textContent=t.format(e),a.classList.add("day-number");let o=document.createElement("div");o.textContent=n.format(e),o.classList.add("day-name");let d=document.createElement("div");d.classList.add("week-number"),1==e.getDay()&&r.checked&&(d.textContent=u(e).toString());let i=[a,o,d];return i.forEach(t=>{t.classList.add("day","calendarItem"),t.setAttribute("data-month",(e.getMonth()+1).toString()),t.setAttribute("data-dayofweek",e.getDay().toString()),t.setAttribute("data-day",e.getDate().toString())}),i},l=t=>{e.innerHTML="";let r=document.createElement("div");r.id="calendarContainer",r.setAttribute("data-monthsperpage",n.value),r.setAttribute("data-shadeWeekends",String(a.checked)),e.appendChild(r);let u=Array.from({length:12},(e,t)=>t);u.forEach(e=>{let n=document.createElement("div");n.classList.add("monthContainer");let a=d(t,e);n.appendChild(a),o(t,e).forEach(e=>{i(e).forEach(e=>n.appendChild(e))}),r.append(n)})};t.addEventListener("change",()=>{l(Number(t.value))}),n.addEventListener("change",()=>{l(Number(t.value))}),a.addEventListener("change",()=>{l(Number(t.value))}),r.addEventListener("change",()=>{l(Number(t.value))}),t.value=new Date().getFullYear().toString(),l(Number(t.value));