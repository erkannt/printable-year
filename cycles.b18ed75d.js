const e=document.querySelector("#appContainer");if(!e)throw Error("ERROR: no appContainer found");const t=document.querySelector("#yearInput");if(!t)throw Error("ERROR: no yearInput found");if(!(t instanceof HTMLInputElement))throw Error("ERROR: yearInput not an input");const n=document.querySelector("#shadeWeekends");if(!n)throw Error("ERROR: no shadeWeekendInput found");if(!(n instanceof HTMLInputElement))throw Error("ERROR: shadeWeekendsInput not an input");const r=document.querySelector("#showWeeknumbers");if(!r)throw Error("ERROR: no showWeeknumbersInput found");if(!(r instanceof HTMLInputElement))throw Error("ERROR: showWeeknumbersInput not an input");const a=(e,t)=>{let n=new Date(e,0,7*(13*t)-d(e)),r=[];for(let e=0;e<=91;e++){let t=new Date(n.getTime()+864e5*e);r.push(t)}return r},o=(e,t)=>{let n=document.createElement("span");return n.textContent=`Quarter ${(t+1).toString()}`,n.classList.add("quarterHeader","calendarItem"),n.setAttribute("data-quarter",(t+1).toString()),n},d=e=>{let t=new Date(e,0,1),n=t.getDay();return 0===n?6:n-1},u=e=>{let t=new Date(e.getTime());t.setHours(0,0,0,0),// Thursday in current week decides the year.
t.setDate(t.getDate()+3-(t.getDay()+6)%7);// January 4 is always in week 1.
let n=new Date(t.getFullYear(),0,4);// Adjust to Thursday in week 1 and count number of weeks from date to week1.
return 1+Math.round(((t.getTime()-n.getTime())/864e5-3+(n.getDay()+6)%7)/7)},i=e=>{let t=new Intl.DateTimeFormat("default",{day:"2-digit"}),n=document.createElement("div");n.textContent=t.format(e),n.classList.add("day-number");let a=document.createElement("div");a.classList.add("week-number"),1==e.getDay()&&r.checked&&(a.textContent=u(e).toString());let o=[n,a];return o.forEach(t=>{t.classList.add("day","calendarItem"),t.setAttribute("data-month",(e.getMonth()+1).toString()),t.setAttribute("data-dayofweek",e.getDay().toString()),t.setAttribute("data-day",e.getDate().toString())}),o},s=t=>{e.innerHTML="";let r=document.createElement("div");r.id="yearContainer",r.setAttribute("data-shadeWeekends",String(n.checked)),e.appendChild(r);let d=Array.from({length:4},(e,t)=>t);d.forEach(e=>{let n=document.createElement("div");n.classList.add("quarterContainer"),n.appendChild(o(t,e)),a(t,e).forEach(e=>{i(e).forEach(e=>n.appendChild(e))}),r.append(n)})};t.addEventListener("change",()=>{s(Number(t.value))}),n.addEventListener("change",()=>{s(Number(t.value))}),r.addEventListener("change",()=>{s(Number(t.value))}),t.value=new Date().getFullYear().toString(),s(Number(t.value));